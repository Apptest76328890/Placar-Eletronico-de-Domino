<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pontuação de Dominó</title>
  <style>
    :root {
      --time1-bg: #B3CDE0;
      --time1-cor: #4D4D4D;
      --time2-bg: #BFDAB5;
      --time2-cor: #4D4D4D;
      --botao-bg: #E5E5E5;
      --botao-raio: 8px;
      --botao-padding: 14px;
      --familia-fonte: 'Open Sans', sans-serif;
      --botao-duracao-press: 0.5s;
    }

    body, html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      font-family: var(--familia-fonte);
      background: #F5F5F5;
    }

    .container {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .cartao {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
      position: relative;
      border-radius: 15px;
      margin: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .pontuacao {
      font-size: 5em;
      font-weight: bold;
      margin: auto 0;
    }

    .container-botao {
      display: flex;
      gap: 14px;
      justify-content: center;
    }

    .botao {
      min-width: 70px;
      padding: var(--botao-padding);
      border: none;
      border-radius: var(--botao-raio);
      cursor: pointer;
      font-size: 1.6em;
      color: #000;
      background-color: var(--botao-bg);
      transition: background-color var(--botao-duracao-press);
    }

    .botao:active {
      filter: brightness(85%);
    }

    .botao-desfazer {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #fff;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .botao-desfazer img {
      width: 24px;
      height: 24px;
    }

    @media (orientation: landscape) {
      .container {
        flex-direction: row;
      }
    }
  </style>
</head>
<body>
  <main id="container-cartoes" class="container"></main>

  <script>
    // Solicitar Wake Lock para manter a tela ativa
    if ('wakeLock' in navigator) {
      let wakeLock = null;

      const requestWakeLock = async () => {
        try {
          wakeLock = await navigator.wakeLock.request('screen');
          console.log('Wake Lock ativo!');
        } catch (err) {
          console.error(`${err.name}, ${err.message}`);
        }
      };

      requestWakeLock();

      // Atualizar Wake Lock em caso de visibilidade mudar
      document.addEventListener('visibilitychange', async () => {
        if (wakeLock !== null && document.visibilityState === 'visible') {
          requestWakeLock();
        }
      });
    }

    class Time {
      constructor({ id, nome, corDeFundo, corTexto }) {
        this.id = id;
        this.nome = nome;
        this.corDeFundo = corDeFundo;
        this.corTexto = corTexto;
        this.pontuacao = 0;
        this.historicoPontos = [];
      }

      adicionarPontos(pontos) {
        this.pontuacao += pontos;
        this.historicoPontos.push(pontos);
      }

      desfazerPontos() {
        const ultimoPonto = this.historicoPontos.pop();
        if (ultimoPonto !== undefined) {
          this.pontuacao -= ultimoPonto;
        }
      }
    }

    class Jogo {
      constructor(configuracaoTimes, opcoesPontos, idContainer) {
        this.times = configuracaoTimes.map(config => new Time(config));
        this.opcoesPontos = opcoesPontos;
        this.container = document.getElementById(idContainer);
      }

      iniciar() {
        this.container.innerHTML = '';
        this.times.forEach(time => this.criarCartao(time));
      }

      criarCartao(time) {
        const cartao = this.criarElementosCartao(time);
        this.container.appendChild(cartao);
        this.adicionarEventos(cartao, time);
      }

      criarElementosCartao(time) {
        const cartao = document.createElement('div');
        cartao.classList.add('cartao');
        cartao.style.backgroundColor = time.corDeFundo;

        cartao.innerHTML = `
          <button class="botao-desfazer">
            <img src="https://img.icons8.com/material-outlined/24/000000/undo.png" alt="Desfazer">
          </button>
          <span class="pontuacao" style="color: ${time.corTexto};">${time.pontuacao}</span>
          <div class="container-botao">
            ${this.opcoesPontos.map(pontos => this.criarBotaoPontos(pontos)).join('')}
          </div>
        `;
        return cartao;
      }

      criarBotaoPontos(pontos) {
        return `<button class="botao" data-valor="${pontos}">${pontos}</button>`;
      }

      adicionarEventos(cartao, time) {
        cartao.querySelector('.botao-desfazer').addEventListener('click', () => this.desfazerPontos(time, cartao));
        cartao.querySelectorAll('.botao').forEach(botao => {
          botao.addEventListener('click', () => this.adicionarPontos(time, parseInt(botao.getAttribute('data-valor')), cartao));
        });
      }

      atualizarPontuacao(cartao, time) {
        cartao.querySelector('.pontuacao').textContent = time.pontuacao;
      }

      adicionarPontos(time, pontos, cartao) {
        time.adicionarPontos(pontos);
        this.atualizarPontuacao(cartao, time);
      }

      desfazerPontos(time, cartao) {
        time.desfazerPontos();
        this.atualizarPontuacao(cartao, time);
      }
    }

    const configuracao = {
      times: [
        { id: 'time1', nome: 'Time 1', corDeFundo: 'var(--time1-bg)', corTexto: 'var(--time1-cor)' },
        { id: 'time2', nome: 'Time 2', corDeFundo: 'var(--time2-bg)', corTexto: 'var(--time2-cor)' }
      ],
      opcoesPontos: [5, 10, 20, 50]
    };

    const jogo = new Jogo(configuracao.times, configuracao.opcoesPontos, 'container-cartoes');
    jogo.iniciar();
  </script>
</body>
</html>
